# Collecting Argo Workflow Logs Using Fluentd
### What is Argo Workflow?
As described in [here][1], Argo Workflows is an open source container-native workflow engine for orchestrating parallel jobs on Kubernetes. Argo Workflows is implemented as a Kubernetes CRD (Custom Resource Definition).Here are what we can do using Argo:

* Define workflows where each step in the workflow is a container.
* Model multi-step workflows as a sequence of tasks or capture the dependencies between tasks using a directed acyclic graph (DAG).
* Easily run compute intensive jobs for machine learning or data processing in a fraction of the time using Argo Workflows on Kubernetes.
* Argo is a Cloud Native Computing Foundation (CNCF) graduated project.

First, let's install and learn the basics of using Argo Workflows. The following materials are mainly from this [Killercoda course][2] which is created by Argo creaters themseslves!

### 1. Installing Argo Workflows on Minikube
```%sh
# creating a new minikube cluster called argo
$ minikube start -p argo

# setting the default minikube profile to argo
$ minikube profile argo

# setting the kubetl context to our new minikube argo cluster
$kubectl config use-context argo

# creating a new namespace to host argo deployments and services
$kubectl create namespace argo

# installing argo workflows
$kubectl apply -n argo -f https://github.com/argoproj/argo-workflows/releases/download/v3.4.9/install.yaml
```
Two deployments would have to be installed if the above has been executed successfully:

```
$ kubectl get deployments -n argo

NAME                  READY   UP-TO-DATE   AVAILABLE   AGE
argo-server           1/1     1            1           18m
workflow-controller   1/1     1            1           18m
```

The *__Workflow Controller__* is responsible for running workflows and the *__Argo Server__* provides a user interface and API.

### 2. Creating and Running a Simple Workflow
A workflow is defined as a Kubernetes resource. Each workflow consists of one or more templates, one of which is defined as the entrypoint. Each template can be one of several types, in this example we have one template that is a container.

The ```hello-workflow.yaml``` in this directory contains one template that is a container. 

```%sh
# creating a workflow
$ kubectl -n argo apply -f hello-workflow.yaml
```

Preferably, we use Argo CLI to run workflows, instead of kubectl:
```%sh
# submitting a workflow using Argo CLI
$ argo submit -n argo --watch hello-workflow.yaml
```

We can get more info and details about the workflows using the following commands:
```%sh
# listing workflows
$ argo list -n argo

# getting details of a workflow
$ argo get -n argo hello

#getting logs generated by a workflow
$ argo logs -n argo hello
```

[1]: https://argoproj.github.io/argo-workflows/
[2]: https://killercoda.com/pipekit/course/argo-workflows/

